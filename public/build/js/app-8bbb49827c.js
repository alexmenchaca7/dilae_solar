document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector("#hamburguesa"),t=document.querySelector("#navegacion"),o=document.querySelector("#cerrar-nav"),n=document.body;e&&t&&o&&(e.addEventListener("click",(()=>{t.classList.add("visible"),n.classList.add("no-scroll")})),o.addEventListener("click",(()=>{t.classList.remove("visible"),n.classList.remove("no-scroll")})),t.addEventListener("click",(e=>{e.target===t&&(t.classList.remove("visible"),n.classList.remove("no-scroll"))})));const a=document.querySelector(".index-garantia");if(a){const L=document.querySelectorAll(".index-garantia__selector"),_=document.querySelectorAll(".index-garantia__contenido-item"),B=document.querySelectorAll(".index-garantia__indicador");let I=1;const w=L.length;let S;function i(e){I=parseInt(e),_.forEach((e=>e.classList.remove("activo"))),L.forEach((e=>e.classList.remove("activo"))),B.forEach((e=>e.classList.remove("activo")));const t=document.querySelector(`.index-garantia__contenido-item[data-tab="${e}"]`),o=document.querySelector(`.index-garantia__selector[data-target="${e}"]`),n=document.querySelector(`.index-garantia__indicador[data-indicador="${e}"]`);t&&t.classList.add("activo"),o&&o.classList.add("activo"),n&&n.classList.add("activo")}function r(){I++,I>w&&(I=1),i(I)}function s(){clearInterval(S),S=setInterval(r,7500)}function c(){clearInterval(S)}function l(){c(),s()}L.forEach((e=>{e.addEventListener("click",(function(){i(this.getAttribute("data-target")),l()}))})),B.forEach((e=>{e.addEventListener("click",(function(){i(this.getAttribute("data-indicador")),l()}))})),a.addEventListener("mouseenter",c),a.addEventListener("mouseleave",s),s()}if(document.querySelector(".nosotros-proceso__carousel")){const x=document.querySelector(".nosotros-proceso__items"),C=document.getElementById("prevBtn"),k=document.getElementById("nextBtn"),q=()=>{const e=x.scrollLeft,t=x.scrollWidth,o=x.clientWidth;C.disabled=e<1,k.disabled=e+o>=t-1};k.addEventListener("click",(()=>{const e=x.querySelector(".nosotros-proceso__item").offsetWidth,t=parseInt(window.getComputedStyle(x).gap,10);x.scrollLeft+=e+t})),C.addEventListener("click",(()=>{const e=x.querySelector(".nosotros-proceso__item").offsetWidth,t=parseInt(window.getComputedStyle(x).gap,10);x.scrollLeft-=e+t})),x.addEventListener("scroll",q),q()}const d=document.querySelectorAll(".index-resultados__item, .nosotros-contador__item");if(d.length>0){const M=750,R=e=>{const t=+e.dataset.target;let o=0;const n=t/(M/16.67),a=()=>{o+=n,o<t?(e.innerText=`${Math.floor(o)}`,requestAnimationFrame(a)):e.innerText=`${t}`};a()},D=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){const o=e.target.querySelector(".contador");o&&R(o),t.unobserve(e.target)}}))}),{threshold:.5});d.forEach((e=>{D.observe(e)}))}if(document.getElementById("tipo_tarifa")){const $=document.getElementById("montoPorBimestre"),T=document.getElementById("gastoPromedioContainer"),P=document.getElementById("bimestresContainer"),F=document.getElementById("infoConsumoHistorico"),Q=document.querySelector(".formulario__opcion-bimestre-grid"),G=document.getElementById("gasto_bimestral"),N=Array.from(P.querySelectorAll("input")),W=document.querySelector(".formulario"),O=[G,...N];function u(e){if(""===e||null===e)return"";const t=parseFloat(e);return isNaN(t)?"":"$"+t.toLocaleString("es-MX",{minimumFractionDigits:2,maximumFractionDigits:2})}function m(e){return e?e.replace(/[^0-9.]/g,""):""}function f(){$.checked?(Q.classList.add("grid-activo"),T.classList.add("hidden"),G&&(G.required=!1),P.classList.add("visible"),F.classList.remove("hidden"),N.forEach((e=>e.required=!0))):(Q.classList.remove("grid-activo"),T.classList.remove("hidden"),G&&(G.required=!0),P.classList.remove("visible"),F.classList.add("hidden"),N.forEach((e=>e.required=!1)))}O.forEach((e=>{e&&(e.value&&(e.value=u(m(e.value))),e.addEventListener("input",(e=>{const t=e.target;let o=t.value.replace(/[^0-9]/g,"");if(""===o)return void(t.value="");const n=parseInt(o,10).toLocaleString("es-MX");t.value="$"+n})),e.addEventListener("blur",(()=>{const t=m(e.value);e.value=u(t)})))})),W&&W.addEventListener("submit",(()=>{$.disabled&&($.disabled=!1),O.forEach((e=>{e&&(e.value=m(e.value))}))})),$.addEventListener("change",f),f()}function A(e,t){const o=document.getElementById(e),n=document.getElementById(t);if(o&&n){const e=n.querySelector(".modal-cerrar");o.addEventListener("click",(()=>{n.classList.add("visible")})),e.addEventListener("click",(()=>{n.classList.remove("visible")})),n.addEventListener("click",(e=>{e.target===n&&n.classList.remove("visible")}))}}A("info-tarifa-trigger","recibo-modal"),A("infoConsumoHistorico","consumo-modal");const p=document.getElementById("myBarChart");if(p&&"undefined"!=typeof datosGrafica){const U=1.25*Math.max(...datosGrafica.produccionBimestral,datosGrafica.consumoPromedio);new Chart(p,{type:"bar",data:{labels:["Ene - Feb","Mar - Abr","May - Jun","Jul - Ago","Sep - Oct","Nov - Dic"],datasets:[{label:"Producción Bimestral Estimada",data:datosGrafica.produccionBimestral,backgroundColor:"#001F3F",borderColor:"#001F3F",borderWidth:1,categoryPercentage:.8,barPercentage:.8,yAxisID:"y"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:!0},annotation:{annotations:{consumoPromedio:{type:"line",yMin:datosGrafica.consumoPromedio,yMax:datosGrafica.consumoPromedio,borderColor:"#C7922A",borderWidth:3,borderDash:[7,7],label:{display:!1}}}}},scales:{x:{grid:{display:!1},ticks:{color:"#B1BAC4",font:{size:12,family:"'Inter', sans-serif",weight:"500"}}},y:{beginAtZero:!0,suggestedMax:U,border:{display:!1},ticks:{maxTicksLimit:6,color:"#B1BAC4",font:{size:12,family:"'Inter', sans-serif",weight:"500"},callback:function(e,t,o){return e}},grid:{color:"#B1BAC4",lineWidth:2,drawBorder:!1,drawTicks:!1}}}}})}const g=document.getElementById("calculadoraChart");if(g&&"undefined"!=typeof datosGraficaLinea){const{inversionInicial:J,gananciaNetaFinal:X,aniosROI:j,roiTexto:V}=datosGraficaLinea,z="#C7922A",H="#001F3F",Y="#6E6E6E",K=(X-J)/25,Z=Array.from({length:26},((e,t)=>t)),ee=Z.map((e=>J+K*e)),te=Math.round(j),oe=[J,...Array(25).fill(null)],ne=[...Array(te).fill(null),0,...Array(25-te).fill(null)],ae=[...Array(25).fill(null),X];new Chart(g,{type:"line",data:{labels:Z,datasets:[{label:"Ganancia Acumulada",data:ee,order:1,borderWidth:0,fill:!0,tension:0,pointRadius:0,backgroundColor:function(e){const t=e.chart,{ctx:o,chartArea:n}=t;if(!n)return null;const a=o.createLinearGradient(0,n.top,0,n.bottom),i=t.scales.y,r=i.getPixelForValue(0);if(i.min>=0)return z;if(i.max<=0)return H;const s=(r-n.top)/n.height;return a.addColorStop(0,z),a.addColorStop(s,z),a.addColorStop(s,H),a.addColorStop(1,H),a}},{label:`Inversión Inicial: $${new Intl.NumberFormat("es-MX").format(Math.abs(J))} MXN`,data:oe,order:2,pointBackgroundColor:H,pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:8,pointHoverRadius:10,pointStyle:"circle"},{label:`Retorno de Inversión: ${V}`,data:ne,order:2,pointBackgroundColor:Y,pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:8,pointHoverRadius:10,pointStyle:"circle"},{label:`Ganancia Neta: $${new Intl.NumberFormat("es-MX").format(X)} MXN`,data:ae,order:2,pointBackgroundColor:z,pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:8,pointHoverRadius:10,pointStyle:"circle"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",align:"center",labels:{boxWidth:15,padding:20,usePointStyle:!0,filter:e=>0!==e.datasetIndex,font:{size:12,family:"'Inter', sans-serif"}}},tooltip:{intersect:!1,mode:"nearest",callbacks:{title:function(e){const t=e[0];return t.datasetIndex>0?t.dataset.label:`Año ${t.label}`},label:function(e){if(0===e.datasetIndex){let t=e.parsed.y;return(t>=0?"Ganancia Acumulada: ":"Inversión: ")+"$"+new Intl.NumberFormat("es-MX").format(t)}return""}}}},annotation:{drawTime:"beforeDatasetsDraw",annotations:{line1:{type:"line",xMin:j,xMax:j,borderColor:Y,borderWidth:2,borderDash:[6,6],label:{content:`ROI: ${V}`,enabled:!0,position:"start",backgroundColor:"#dc3545",font:{size:10,weight:"bold"},yAdjust:-15}}}},scales:{y:{ticks:{callback:function(e){return"$"+new Intl.NumberFormat("es-MX").format(e)}}},x:{title:{display:!0,text:"Años",font:{size:12,family:"'Inter', sans-serif"}},ticks:{callback:function(e,t){return Z[t]%5==0?Z[t]:""},maxRotation:0,minRotation:0}}}}})}const v=document.querySelectorAll(".form-suscripcion-ajax");function y(e,t){const o=document.querySelector(".alerta-popup");o&&o.remove();const n=document.createElement("div");n.className=`alerta-popup alerta--${t}`,n.textContent=e,document.body.appendChild(n),getComputedStyle(n).opacity,n.classList.add("visible"),setTimeout((()=>{n.classList.remove("visible"),n.addEventListener("transitionend",(()=>{n.remove()}),{once:!0})}),4e3)}v.length>0&&v.forEach((e=>{e.addEventListener("submit",(async function(e){e.preventDefault();const t=this.querySelector('button[type="submit"], input[type="submit"]'),o=this.querySelector('input[type="email"]'),n=new FormData(this);t&&(t.disabled=!0);try{const e=await fetch("/subscribe",{method:"POST",body:n}),t=await e.json();y(t.message,t.status)}catch(e){console.error("Error al enviar el formulario:",e),y("Ocurrió un error de conexión. Inténtalo de nuevo.","error")}finally{t&&(t.disabled=!1),o&&(o.value="")}}))}));const b=document.querySelector(".dashboard__mobile-menu"),h=document.querySelector(".dashboard__sidebar");b&&h&&(b.addEventListener("click",(function(){h.classList.toggle("sidebar--mostrar")})),document.body.addEventListener("click",(function(e){h.contains(e.target)||b.contains(e.target)||h.classList.remove("sidebar--mostrar")}))),[{inputId:"meta_title",counterId:"meta_title_counter",indicatorId:"meta_title_indicator",optimalMin:40,max:60},{inputId:"meta_description",counterId:"meta_description_counter",indicatorId:"meta_description_indicator",optimalMin:120,max:155}].forEach((e=>{const t=document.getElementById(e.inputId),o=document.getElementById(e.counterId),n=document.getElementById(e.indicatorId);if(t&&o&&n){const a=n.querySelector(".indicator-bar-fill");if(!a)return;const i=()=>{const n=t.value.length;o.textContent=`${n}/${e.max}`;let i="error";n>=e.optimalMin&&n<=e.max?i="good":n>0&&n<e.optimalMin?i="warn":n>e.max?i="error":0===n&&(i="empty"),a.className="indicator-bar-fill","empty"!==i&&a.classList.add(i);const r=Math.min(n/e.max*100,100);a.style.width=`${r}%`};t.addEventListener("input",i),i()}}));document.querySelectorAll(".btn-favorito").forEach((e=>{e.addEventListener("click",(function(){!async function(e,t){const o=new FormData;o.append("id",e);try{const e="/api/like",n=await fetch(e,{method:"POST",body:o}),a=await n.json();if("success"===a.status){t.parentElement.querySelector(".likes-count").textContent=a.likes;const e=t.querySelector("svg");a.liked?e.classList.add("liked"):e.classList.remove("liked")}}catch(e){console.error("Error:",e)}}(this.dataset.id,this)}))}));const E=document.querySelector(".entrada-blog[data-blog-id]");if(E){!async function(e){const t=new FormData;t.append("id",e);try{const e="/api/view";await fetch(e,{method:"POST",body:t})}catch(e){console.error("Error registrando la vista:",e)}}(E.dataset.blogId)}})),function(e,t){function o(e,t){return typeof e===t}function n(e){var t=d.className,o=c._config.classPrefix||"";if(u&&(t=t.baseVal),c._config.enableJSClass){var n=new RegExp("(^|\\s)"+o+"no-js(\\s|$)");t=t.replace(n,"$1"+o+"js$2")}c._config.enableClasses&&(t+=" "+o+e.join(" "+o),u?d.className.baseVal=t:d.className=t)}function a(e,t){if("object"==typeof e)for(var o in e)l(e,o)&&a(o,e[o]);else{var i=(e=e.toLowerCase()).split("."),r=c[i[0]];if(2==i.length&&(r=r[i[1]]),void 0!==r)return c;t="function"==typeof t?t():t,1==i.length?c[i[0]]=t:(!c[i[0]]||c[i[0]]instanceof Boolean||(c[i[0]]=new Boolean(c[i[0]])),c[i[0]][i[1]]=t),n([(t&&0!=t?"":"no-")+i.join("-")]),c._trigger(e,t)}return c}var i=[],r=[],s={_version:"3.6.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var o=this;setTimeout((function(){t(o[e])}),0)},addTest:function(e,t,o){r.push({name:e,fn:t,options:o})},addAsyncTest:function(e){r.push({name:null,fn:e})}},c=function(){};c.prototype=s,c=new c;var l,d=t.documentElement,u="svg"===d.nodeName.toLowerCase();!function(){var e={}.hasOwnProperty;l=o(e,"undefined")||o(e.call,"undefined")?function(e,t){return t in e&&o(e.constructor.prototype[t],"undefined")}:function(t,o){return e.call(t,o)}}(),s._l={},s.on=function(e,t){this._l[e]||(this._l[e]=[]),this._l[e].push(t),c.hasOwnProperty(e)&&setTimeout((function(){c._trigger(e,c[e])}),0)},s._trigger=function(e,t){if(this._l[e]){var o=this._l[e];setTimeout((function(){var e;for(e=0;e<o.length;e++)(0,o[e])(t)}),0),delete this._l[e]}},c._q.push((function(){s.addTest=a})),c.addAsyncTest((function(){function e(e,t,o){function n(t){var n=!(!t||"load"!==t.type)&&1==i.width;a(e,"webp"===e&&n?new Boolean(n):n),o&&o(t)}var i=new Image;i.onerror=n,i.onload=n,i.src=t}var t=[{uri:"data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA=",name:"webp"},{uri:"data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==",name:"webp.alpha"},{uri:"data:image/webp;base64,UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA",name:"webp.animation"},{uri:"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",name:"webp.lossless"}],o=t.shift();e(o.name,o.uri,(function(o){if(o&&"load"===o.type)for(var n=0;n<t.length;n++)e(t[n].name,t[n].uri)}))})),function(){var e,t,n,a,s,l;for(var d in r)if(r.hasOwnProperty(d)){if(e=[],(t=r[d]).name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(a=o(t.fn,"function")?t.fn():t.fn,s=0;s<e.length;s++)1===(l=e[s].split(".")).length?c[l[0]]=a:(!c[l[0]]||c[l[0]]instanceof Boolean||(c[l[0]]=new Boolean(c[l[0]])),c[l[0]][l[1]]=a),i.push((a?"":"no-")+l.join("-"))}}(),n(i),delete s.addTest,delete s.addAsyncTest;for(var m=0;m<c._q.length;m++)c._q[m]();e.Modernizr=c}(window,document);