<IfModule mod_rewrite.c>
    RewriteEngine On

    # Reenvía todas las solicitudes que no apuntan directamente a la carpeta /public
    # a esa carpeta para que sea procesada.
    RewriteCond %{REQUEST_URI} !^/public/
    RewriteRule ^(.*)$ public/$1 [L]
</IfModule>

# --- Mantenemos tus excelentes reglas de seguridad ---

# Prevenir el listado de directorios
Options -Indexes

# Denegar acceso a archivos sensibles
<Files ".env">
    Require all denied
</Files>
<Files "composer.json">
    Require all denied
</Files>
<Files "composer.lock">
    Require all denied
</Files>
<Files "gulpfile.js">
    Require all denied
</Files>
<Files "package.json">
    Require all denied
</Files>
<Files "package-lock.json">
    Require all denied
</Files>

# Denegar acceso directo a las carpetas de la aplicación
<IfModule mod_authz_core.c>
    <DirectoryMatch "^/(includes|models|controllers|classes|vendor|src|views)/">
        Require all denied
    </DirectoryMatch>
</IfModule>
<IfModule !mod_authz_core.c>
    <IfModule mod_access_compat.c>
        <DirectoryMatch "^/(includes|models|controllers|classes|vendor|src|views)/">
            Deny from all
        </DirectoryMatch>
    </IfModule>
</IfModule>
